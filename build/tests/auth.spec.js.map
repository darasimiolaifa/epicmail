{"version":3,"sources":["../../src/tests/auth.spec.js"],"names":["chai","use","chaiHttp","should","url","describe","beforeEach","it","request","app","post","send","username","firstname","lastname","password","end","err","res","data","body","have","status","be","json","a","property","error","not","missingValues","an","include","invalidInput","req","token"],"mappings":"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","sourcesContent":["/* eslint-disable no-undef */\r\n/* eslint-disable no-trailing-spaces */\r\nimport chai from 'chai';\r\nimport chaiHttp from 'chai-http';\r\nimport app from '../server';\r\n\r\nchai.use(chaiHttp);\r\nchai.should();\r\nlet url;\r\n\r\ndescribe('Authentication API', () => {\r\n  describe('POST /api/v1/auth/signup', () => {\r\n    beforeEach(() => {\r\n      url = '/api/v1/auth/signup';\r\n    });\r\n    it('should sign up the new user and return a token', () => {\r\n      chai.request(app)\r\n        .post(url)\r\n        .send({\r\n          username: 'imonitie.yahoo',\r\n          firstname: 'Imonitie',\r\n          lastname: 'Yahoo',\r\n          password: 'imonitie.yahoo',\r\n        })\r\n        .end((err, res) => {\r\n          const { data } = res.body;\r\n          res.should.have.status(201);\r\n          // eslint-disable-next-line no-unused-expressions\r\n          res.should.be.json;\r\n          res.body.should.be.a('object');\r\n          res.body.should.have.property('status', 201);\r\n          res.body.should.have.property('data');\r\n          data.should.be.a('object');\r\n          data.should.have.property('token');\r\n        });\r\n    });\r\n    it('should return an error when one of the field is missing', () => {\r\n      chai.request(app)\r\n        .post(url)\r\n        .send({\r\n          firstname: 'Imonitie',\r\n          lastname: 'Yahoo',\r\n          password: '',\r\n          username: 'imonitie.yahoo',\r\n        })\r\n        .end((err, res) => {\r\n          const { error } = res.body;\r\n          res.should.have.status(400);\r\n          res.body.should.not.have.property('data');\r\n          res.body.should.have.property('status', 400);\r\n          res.body.should.have.property('error');\r\n          error.should.have.property('missingValues');\r\n          error.missingValues.should.be.an('array');\r\n          error.missingValues.should.include('password');\r\n        });\r\n    });\r\n    it('should return an error for a username already in the database', () => {\r\n      chai.request(app)\r\n        .post(url)\r\n        .send({\r\n          username: 'darasimiolaifa',\r\n          firstname: 'Isaiah',\r\n          lastname: 'Ibikunle',\r\n          password: 'monkeys4real',\r\n        })\r\n        .end((err, res) => {\r\n          const { error } = res.body;\r\n          res.should.have.status(400);\r\n          res.body.should.have.property('status', 400);\r\n          res.body.should.have.property('error');\r\n          error.should.have.property('invalidInput');\r\n          error.invalidInput.should.be.an('object');\r\n          error.invalidInput.should.have.property('username');\r\n        });\r\n    });\r\n    it('should return an error for a username that contains invalid characters', () => {\r\n      chai.request(app)\r\n        .post(url)\r\n        .send({\r\n          username: '$#@ollarjay)(',\r\n          firstname: 'Isaiah',\r\n          lastname: 'Ibikunle',\r\n          password: 'monkeys4real',\r\n        })\r\n        .end((err, res) => {\r\n          const { error } = res.body;\r\n          res.should.have.status(400);\r\n          res.body.should.have.property('status', 400);\r\n          res.body.should.have.property('error');\r\n          error.should.have.property('invalidInput');\r\n          error.invalidInput.should.be.an('object');\r\n          error.invalidInput.should.have.property('username');\r\n        });\r\n    });\r\n    it('should reject passwords with less than 8 characters', () => {\r\n      chai.request(app)\r\n        .post(url)\r\n        .send({\r\n          username: 'darasimiolaifa',\r\n          firstname: 'Isaiah',\r\n          lastname: 'Ibikunle',\r\n          password: 'monk',\r\n        })\r\n        .end((req, res) => {\r\n          const { error } = res.body;\r\n          res.should.have.status(400);\r\n          res.body.should.have.property('status', 400);\r\n          res.body.should.have.property('error');\r\n          error.should.have.property('invalidInput');\r\n          error.invalidInput.should.be.an('object');\r\n          error.invalidInput.should.have.property('password');\r\n        });\r\n    });\r\n  });\r\n  \r\n  describe('POST /api/v1/auth/login', () => {\r\n    beforeEach(() => {\r\n      url = '/api/v1/auth/login';\r\n    });\r\n    it('should return a 400 error if any of the fields is missing', () => {\r\n      chai.request(app)\r\n        .post(url)\r\n        .send({\r\n          username: 'darasimiolaifa',\r\n          password: '',\r\n        })\r\n        .end((err, res) => {\r\n          const { error } = res.body;\r\n          res.should.have.status(400);\r\n          res.body.should.not.have.property('data');\r\n          res.body.should.have.property('status', 400);\r\n          res.body.should.have.property('error');\r\n          error.should.have.property('missingValues');\r\n          error.missingValues.should.be.an('array');\r\n          error.missingValues.should.include('password');\r\n        });\r\n    });\r\n    it('should return a 404 error if no stored username matches the one specified', () => {\r\n      chai.request(app)\r\n        .post(url)\r\n        .send({\r\n          username: 'badUser',\r\n          password: 'badPassword',\r\n        })\r\n        .end((err, res) => {\r\n          const { error } = res.body;\r\n          res.should.have.status(404);\r\n          res.body.should.have.property('status', 404);\r\n          res.body.should.have.property('error');\r\n          error.should.have.property('invalidInput');\r\n          error.invalidInput.should.be.an('object');\r\n          error.invalidInput.should.have.property('username');\r\n        });\r\n    });\r\n    it('should return a 400 error the stored password does not match the one specified', () => {\r\n      chai.request(app)\r\n        .post(url)\r\n        .send({\r\n          username: 'darasimiolaifa',\r\n          password: 'wrongpassword',\r\n        })\r\n        .end((err, res) => {\r\n          const { error } = res.body;\r\n          res.should.have.status(400);\r\n          res.body.should.have.property('status', 400);\r\n          res.body.should.property('error');\r\n          error.should.have.property('invalidInput');\r\n          error.invalidInput.should.be.an('object');\r\n          error.invalidInput.should.have.property('password');\r\n        });\r\n    });\r\n    it('should sign in the new user and return a token', () => {\r\n      chai.request(app)\r\n        .post(url)\r\n        .send({\r\n          username: 'darasimiolaifa',\r\n          password: 'darasimiolaifa',\r\n        })\r\n        .end((err, res) => {\r\n          const { data } = res.body;\r\n          res.should.have.status(200);\r\n          res.body.should.be.a('object');\r\n          res.body.should.have.property('status', 200);\r\n          data.should.have.property('token');\r\n          data.token.should.be.a('string');\r\n        });\r\n    });\r\n  });\r\n});\r\n"],"file":"auth.spec.js"}