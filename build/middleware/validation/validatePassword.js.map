{"version":3,"sources":["../../../src/middleware/validation/validatePassword.js"],"names":["validatePassword","url","users","password","username","passwordErrors","statusCode","hasErrors","length","push","foundUser","find","user","bcrypt","hashSync","salt"],"mappings":";;;;;;;AAAA;;;;AAEA,IAAMA,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,GAAD,EAAMC,KAAN,EAAaC,QAAb,EAAuBC,QAAvB,EAAoC;AAC3D,MAAMC,cAAc,GAAG,EAAvB;AACA,MAAIC,UAAU,GAAG,GAAjB;AACA,MAAIC,SAAJ;;AACA,MAAIN,GAAG,KAAK,qBAAZ,EAAmC;AACjC,QAAIE,QAAQ,CAACK,MAAT,GAAkB,CAAtB,EAAyB;AACvBH,MAAAA,cAAc,CAACI,IAAf,CAAoB,kDAApB;AACAF,MAAAA,SAAS,GAAG,IAAZ;AACD;AACF,GALD,MAKO;AACL,QAAMG,SAAS,GAAGR,KAAK,CAACS,IAAN,CAAW,UAAAC,IAAI;AAAA,aAAIA,IAAI,CAACR,QAAL,KAAkBA,QAAtB;AAAA,KAAf,CAAlB;;AACA,QAAIM,SAAJ,EAAe;AACb,UAAIA,SAAS,CAACP,QAAV,KAAuBU,kBAAOC,QAAP,CAAgBX,QAAhB,EAA0BO,SAAS,CAACK,IAApC,CAA3B,EAAsE;AACpEV,QAAAA,cAAc,CAACI,IAAf,CAAoB,sCAApB;AACAF,QAAAA,SAAS,GAAG,IAAZ;AACD;AACF,KALD,MAKO;AACLD,MAAAA,UAAU,GAAG,GAAb;AACD;AACF;;AAED,SAAO;AAAED,IAAAA,cAAc,EAAdA,cAAF;AAAkBC,IAAAA,UAAU,EAAVA,UAAlB;AAA8BC,IAAAA,SAAS,EAATA;AAA9B,GAAP;AACD,CAtBD;;eAwBeP,gB","sourcesContent":["import bcrypt from 'bcryptjs';\n\nconst validatePassword = (url, users, password, username) => {\n  const passwordErrors = [];\n  let statusCode = 400;\n  let hasErrors;\n  if (url === '/api/v1/auth/signup') {\n    if (password.length < 8) {\n      passwordErrors.push('Passwords must be 8 characters or more in length');\n      hasErrors = true;\n    }\n  } else {\n    const foundUser = users.find(user => user.username === username);\n    if (foundUser) {\n      if (foundUser.password !== bcrypt.hashSync(password, foundUser.salt)) {\n        passwordErrors.push('Username and password does not match');\n        hasErrors = true;\n      }\n    } else {\n      statusCode = 404;\n    }\n  }\n  \n  return { passwordErrors, statusCode, hasErrors };\n};\n\nexport default validatePassword;\n"],"file":"validatePassword.js"}