{"version":3,"sources":["../../../src/middleware/validation/validatePassword.js"],"names":["url","users","password","username","passwordErrors","error","status","length","push","foundUser","find","user","bcrypt","compareSync"],"mappings":";;;;;;;AAAA;;;;eAEe,kBAACA,GAAD,EAAMC,KAAN,EAAaC,QAAb,EAAuBC,QAAvB,EAAoC;AACjD,MAAMC,cAAc,GAAG,EAAvB;AACA,MAAMC,KAAK,GAAG,EAAd;AACA,MAAIC,MAAM,GAAG,GAAb;;AAEA,MAAIN,GAAG,KAAK,qBAAZ,EAAmC;AACjC,QAAIE,QAAQ,CAACK,MAAT,GAAkB,CAAtB,EAAyB;AACvBH,MAAAA,cAAc,CAACI,IAAf,CAAoB,kDAApB;AACAF,MAAAA,MAAM,GAAG,GAAT;AACD;AACF,GALD,MAKO;AACL,QAAMG,SAAS,GAAGR,KAAK,CAACS,IAAN,CAAW,UAAAC,IAAI;AAAA,aAAIA,IAAI,CAACR,QAAL,KAAkBA,QAAtB;AAAA,KAAf,CAAlB;;AACA,QAAIM,SAAJ,EAAe;AACb,UAAI,CAACG,kBAAOC,WAAP,CAAmBX,QAAnB,EAA6BO,SAAS,CAACP,QAAvC,CAAL,EAAuD;AACrDE,QAAAA,cAAc,CAACI,IAAf,CAAoB,sCAApB;AACAF,QAAAA,MAAM,GAAG,GAAT;AACD;AACF,KALD,MAKO;AACLA,MAAAA,MAAM,GAAG,GAAT;AACD;AACF;;AACDD,EAAAA,KAAK,CAACH,QAAN,GAAiBE,cAAjB;AACAC,EAAAA,KAAK,CAACC,MAAN,GAAeA,MAAf;AACA,SAAOD,KAAP;AACD,C","sourcesContent":["import bcrypt from 'bcryptjs';\r\n\r\nexport default (url, users, password, username) => {\r\n  const passwordErrors = [];\r\n  const error = {};\r\n  let status = 200;\r\n  \r\n  if (url === '/api/v1/auth/signup') {\r\n    if (password.length < 8) {\r\n      passwordErrors.push('Passwords must be 8 characters or more in length');\r\n      status = 400;\r\n    }\r\n  } else {\r\n    const foundUser = users.find(user => user.username === username);\r\n    if (foundUser) {\r\n      if (!bcrypt.compareSync(password, foundUser.password)) {\r\n        passwordErrors.push('Username and password does not match');\r\n        status = 400;\r\n      }\r\n    } else {\r\n      status = 404;\r\n    }\r\n  }\r\n  error.password = passwordErrors;\r\n  error.status = status;\r\n  return error;\r\n};\r\n"],"file":"validatePassword.js"}