{"version":3,"sources":["../../../src/middleware/validation/authValidation.js"],"names":["validateAuthData","req","res","next","required","url","body","error","invalidInput","status","missingValueStatus","hasErrors","missingValues","statusCode","invalidUsername","users","username","usernameErrors","invalidPassword","password","passwordErrors","send"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA,IAAMA,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC3C,MAAIC,QAAJ;AAD2C,MAEnCC,GAFmC,GAErBJ,GAFqB,CAEnCI,GAFmC;AAAA,MAE9BC,IAF8B,GAErBL,GAFqB,CAE9BK,IAF8B;;AAI3C,MAAID,GAAG,KAAK,qBAAZ,EAAmC;AACjCD,IAAAA,QAAQ,GAAG,CAAC,WAAD,EAAc,UAAd,EAA0B,UAA1B,EAAsC,UAAtC,CAAX;AACD,GAFD,MAEO;AACLA,IAAAA,QAAQ,GAAG,CAAC,UAAD,EAAa,UAAb,CAAX;AACD;;AAED,MAAMG,KAAK,GAAG;AAAEC,IAAAA,YAAY,EAAE;AAAhB,GAAd;AACA,MAAIC,MAAM,GAAG,GAAb;AAEA,MAAMC,kBAAkB,GAAG,yCAA2BT,GAAG,CAACK,IAA/B,EAAqCF,QAArC,CAA3B;;AACA,MAAIM,kBAAkB,CAACC,SAAvB,EAAkC;AAAA,QACxBC,aADwB,GACMF,kBADN,CACxBE,aADwB;AAAA,QACTC,UADS,GACMH,kBADN,CACTG,UADS;AAEhCN,IAAAA,KAAK,CAACK,aAAN,GAAsBA,aAAtB;AACAH,IAAAA,MAAM,GAAGI,UAAT;AACD;;AAED,MAAMC,eAAe,GAAG,+BAAiBT,GAAjB,EAAsBU,kBAAtB,EAA6BT,IAAI,CAACU,QAAlC,CAAxB;;AACA,MAAIF,eAAe,CAACH,SAApB,EAA+B;AAAA,QACrBM,cADqB,GACUH,eADV,CACrBG,cADqB;AAAA,QACLJ,WADK,GACUC,eADV,CACLD,UADK;AAE7BN,IAAAA,KAAK,CAACC,YAAN,CAAmBQ,QAAnB,GAA8BC,cAA9B;AACAR,IAAAA,MAAM,GAAGI,WAAT;AACD;;AAED,MAAMK,eAAe,GAAG,+BAAiBb,GAAjB,EAAsBU,kBAAtB,EAA6BT,IAAI,CAACa,QAAlC,EAA4Cb,IAAI,CAACU,QAAjD,CAAxB;;AACA,MAAIE,eAAe,CAACP,SAApB,EAA+B;AAAA,QACrBS,cADqB,GACUF,eADV,CACrBE,cADqB;AAAA,QACLP,YADK,GACUK,eADV,CACLL,UADK;AAE7BN,IAAAA,KAAK,CAACC,YAAN,CAAmBW,QAAnB,GAA8BC,cAA9B;AACAX,IAAAA,MAAM,GAAGI,YAAT;AACD;;AAED,MAAIJ,MAAM,KAAK,GAAf,EAAoB;AAClB,WAAOP,GAAG,CAACO,MAAJ,CAAWA,MAAX,EAAmBY,IAAnB,CAAwB;AAC7BZ,MAAAA,MAAM,EAANA,MAD6B;AAE7BF,MAAAA,KAAK,EAALA;AAF6B,KAAxB,CAAP;AAID;;AACDJ,EAAAA,IAAI;AACL,CAzCD;;eA2CeH,gB","sourcesContent":["import checkMissingRequiredValues from './checkMissingRequiredValues';\r\nimport validateUsername from './validateUsername';\r\nimport validatePassword from './validatePassword';\r\nimport users from '../../dummy/usersData';\r\n\r\nconst validateAuthData = (req, res, next) => {\r\n  let required;\r\n  const { url, body } = req;\r\n  \r\n  if (url === '/api/v1/auth/signup') {\r\n    required = ['firstname', 'lastname', 'username', 'password'];\r\n  } else {\r\n    required = ['username', 'password'];\r\n  }\r\n  \r\n  const error = { invalidInput: {} };\r\n  let status = 200;\r\n  \r\n  const missingValueStatus = checkMissingRequiredValues(req.body, required);\r\n  if (missingValueStatus.hasErrors) {\r\n    const { missingValues, statusCode } = missingValueStatus;\r\n    error.missingValues = missingValues;\r\n    status = statusCode;\r\n  }\r\n  \r\n  const invalidUsername = validateUsername(url, users, body.username);\r\n  if (invalidUsername.hasErrors) {\r\n    const { usernameErrors, statusCode } = invalidUsername;\r\n    error.invalidInput.username = usernameErrors;\r\n    status = statusCode;\r\n  }\r\n  \r\n  const invalidPassword = validatePassword(url, users, body.password, body.username);\r\n  if (invalidPassword.hasErrors) {\r\n    const { passwordErrors, statusCode } = invalidPassword;\r\n    error.invalidInput.password = passwordErrors;\r\n    status = statusCode;\r\n  }\r\n  \r\n  if (status !== 200) {\r\n    return res.status(status).send({\r\n      status,\r\n      error,\r\n    });\r\n  }\r\n  next();\r\n};\r\n\r\nexport default validateAuthData;\r\n"],"file":"authValidation.js"}