{"version":3,"sources":["../../../src/middleware/authentication/authenticate.js"],"names":["Authenticate","verifyToken","req","res","next","token","headers","jwt","verify","process","env","SECRET","decodedUser","query","queryFunction","id","rows","user","message"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,IAAMA,YAAY,GAAG;AACbC,EAAAA,WADa,uBACDC,GADC,EACIC,GADJ,EACSC,IADT,EACe;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAC1BC,cAAAA,KAD0B,GAClBH,GAAG,CAACI,OAAJ,CAAY,gBAAZ,CADkB;;AAAA,kBAE3BD,KAF2B;AAAA;AAAA;AAAA;;AAAA,+CAGvB,6BAAeF,GAAf,EAAoB,uBAApB,EAA6C,GAA7C,CAHuB;;AAAA;AAAA;AAAA;AAAA,qBAMJI,sBAAIC,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,MAA9B,CANI;;AAAA;AAMxBC,cAAAA,WANwB;AAOxBC,cAAAA,KAPwB,GAOhB,mCAPgB;AAAA;AAAA,qBAQPC,kBAAcD,KAAd,CAAoBA,KAApB,EAA2B,CAACD,WAAW,CAACG,EAAb,CAA3B,CARO;;AAAA;AAAA;AAQtBC,cAAAA,IARsB,QAQtBA,IARsB;;AAAA,kBASzBA,IAAI,CAAC,CAAD,CATqB;AAAA;AAAA;AAAA;;AAAA,+CAUrB,6BAAeb,GAAf,EAAoB,mCAApB,EAAyD,GAAzD,CAVqB;;AAAA;AAY9BD,cAAAA,GAAG,CAACe,IAAJ,GAAWL,WAAX;AAZ8B,+CAavBR,IAAI,EAbmB;;AAAA;AAAA;AAAA;AAAA,+CAevB,6BAAeD,GAAf,EAAoB,YAAMe,OAA1B,EAAmC,GAAnC,CAfuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBjC;AAlBkB,CAArB;eAqBelB,Y","sourcesContent":["import jwt from 'jsonwebtoken';\nimport queryFunction from '../../database';\nimport serverResponse from '../../utils/serverResponse';\n\nconst Authenticate = {\n  async verifyToken(req, res, next) {\n    const token = req.headers['x-access-token'];\n    if (!token) {\n      return serverResponse(res, 'Token is not provided', 400);\n    }\n    try {\n      const decodedUser = await jwt.verify(token, process.env.SECRET);\n      const query = 'SELECT * FROM users WHERE id = $1';\n      const { rows } = await queryFunction.query(query, [decodedUser.id]);\n      if (!rows[0]) {\n        return serverResponse(res, 'The token you provided is invalid', 400);\n      }\n      req.user = decodedUser;\n      return next();\n    } catch (error) {\n      return serverResponse(res, error.message, 400);\n    }\n  },\n};\n\nexport default Authenticate;\n"],"file":"authenticate.js"}