{"version":3,"sources":["../../src/database/db.js"],"names":["pool","Pool","connectionString","process","env","DATABASE_URL","on","console","log","createTables","sql","query","then","res","end","catch","error"],"mappings":";;AAAA;;AACA;;AAEA;AAEA,IAAMA,IAAI,GAAG,IAAIC,QAAJ,CAAS;AACpBC,EAAAA,gBAAgB,EAAEC,OAAO,CAACC,GAAR,CAAYC;AADV,CAAT,CAAb;AAIAL,IAAI,CAACM,EAAL,CAAQ,SAAR,EAAmB,YAAM;AACvBC,EAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACD,CAFD;;AAIA,IAAMC,YAAY,GAAG,SAAfA,YAAe,GAAM;AACzB,MAAMC,GAAG,igDAAT;AAqDAV,EAAAA,IAAI,CAACW,KAAL,CAAWD,GAAX,EACGE,IADH,CACQ,UAACC,GAAD,EAAS;AACbN,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACAR,IAAAA,IAAI,CAACc,GAAL;AACD,GAJH,EAKGC,KALH,CAKS,UAACC,KAAD,EAAW;AAChBT,IAAAA,OAAO,CAACC,GAAR,CAAYQ,KAAZ;AACAhB,IAAAA,IAAI,CAACc,GAAL;AACD,GARH;AASD,CA/DD;;AAiEAL,YAAY","sourcesContent":["import { config } from 'dotenv';\nimport { Pool } from 'pg';\n\nconfig();\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n});\n\npool.on('connect', () => {\n  console.log('Database connected');\n});\n\nconst createTables = () => {\n  const sql = `\n  DROP TABLE IF EXISTS users CASCADE;\n  DROP TABLE IF EXISTS messages CASCADE;\n  DROP TABLE IF EXISTS inbox CASCADE;\n  DROP TABLE IF EXISTS groups CASCADE;\n  DROP TABLE IF EXISTS groups_members CASCADE;\n  \n  CREATE TABLE users(\n    id SERIAL PRIMARY KEY,\n    first_name VARCHAR(255) NOT NULL,\n    last_name VARCHAR(255) NOT NULL,\n    username VARCHAR(255) unique NOT NULL,\n    password VARCHAR(255) NOT NULL,\n    email VARCHAR(255) NOT NULL,\n    created_on TIMESTAMP NOT NULL\n  );\n  \n  CREATE TABLE messages(\n    id SERIAL PRIMARY KEY,\n    subject VARCHAR(255) NOT NULL,\n    message TEXT NOT NULL,\n    sender_id INTEGER NOT NULL,\n    created_on TIMESTAMP NOT NULL,\n    parent_message_id INTEGER,\n    FOREIGN KEY(sender_id) REFERENCES users(id)\n  );\n  \n  CREATE TABLE inbox(\n    message_id INTEGER NOT NULL,\n    receiver_id INTEGER NOT NULL,\n    status VARCHAR(15) NOT NULL,\n    FOREIGN KEY(message_id) REFERENCES messages(id) ON DELETE CASCADE,\n    FOREIGN KEY(receiver_id) REFERENCES users(id) \n  );\n  \n  CREATE TABLE groups(\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    description VARCHAR(255) NOT NULL,\n    created_on TIMESTAMP NOT NULL,\n    group_email VARCHAR(255) NOT NULL,\n    owner_id INTEGER NOT NULL,\n    FOREIGN KEY(owner_id) REFERENCES users(id)\n  );\n  \n  CREATE TABLE groups_members(\n   group_id INTEGER NOT NULL,\n   member_id INTEGER NOT NULL,\n   FOREIGN KEY(group_id) REFERENCES groups(id),\n   FOREIGN KEY(member_id) REFERENCES users(id) \n  );\n  `;\n  \n  pool.query(sql)\n    .then((res) => {\n      console.log('Tables created');\n      pool.end();\n    })\n    .catch((error) => {\n      console.log(error);\n      pool.end();\n    });\n};\n\ncreateTables();\n"],"file":"db.js"}